<!DOCTYPE html>
<html>
<head>
    <title>Gezelle Netwerk - Basis Visualisatie</title>
    
    <script type="text/javascript" src="https://unpkg.com/vis-network@9.1.2/standalone/umd/vis-network.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <style>
        /* Minimale Stijlen */
        #mynetwork {
            width: 100%;
            height: 80vh; /* Zichtbare hoogte */
            min-height: 600px;
            border: 1px solid lightgray;
        }
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
        }
    </style>
</head>
<body>

    <h1>Netwerk Visualisatie Guido Gezelle (Basis)</h1>

    <div id="mynetwork"></div>

    <script type="text/javascript">
        let network = null;
        const container = document.getElementById('mynetwork');
        
        // --- Vis.js Opties ---
        const options = {
            nodes: {
                shape: 'dot',
                font: { size: 14, color: '#333' }, 
                borderWidth: 2
            },
            edges: {
                arrows: 'to',
                color: { inherit: true },
                smooth: { type: 'continuous' }
            },
            physics: {
                enabled: false /* Cruciaal: Gebruikt de X/Y coÃ¶rdinaten uit het CSV */
            }
        };

        // --------------------------------------------------------------------
        // --- Data Laden en Parsen Functies ---
        // --------------------------------------------------------------------

        /**
         * Hulpfunctie om een lokaal CSV-bestand te parsen met PapaParse.
         */
        function parseCSV(url) {
            return new Promise((resolve, reject) => {
                Papa.parse(url, {
                    download: true,
                    header: true,
                    skipEmptyLines: true,
                    dynamicTyping: true, // Zorgt dat nummers als nummers worden gelezen
                    complete: (results) => {
                        if (results.data.length === 0) {
                            reject(new Error(`CSV-bestand ${url} is leeg.`));
                        }
                        resolve(results.data);
                    },
                    error: (error) => reject(error)
                });
            });
        }
        
        /**
         * Laadt de CSV-bestanden, formatteert de data en tekent het netwerk.
         */
        async function loadAndDrawNetwork() {
            try {
                // 1. Data Laden
                const nodesDataRaw = await parseCSV('nodes.csv');
                const edgesDataRaw = await parseCSV('edges.csv');

                // 2. Data Formatteren (Minimalistisch)
                const nodes = new vis.DataSet(
                    nodesDataRaw.map(d => ({
                        id: d.Id, 
                        label: d.Label, 
                        group: d.category,
                        color: d.Color,
                        size: parseFloat(d.Size) || 15,
                        x: parseFloat(d.X), 
                        y: parseFloat(d.Y),
                        fixed: true,
                        // De 'title' wordt gebruikt voor de tooltip bij hover
                        title: `Naam: ${d.Label}\nType: ${d.category}` 
                    }))
                );

                const edges = new vis.DataSet(
                    edgesDataRaw.map(d => ({
                        id: d.Id, 
                        from: d.Source, 
                        to: d.Target, 
                        color: d.Color,
                        // De 'title' wordt gebruikt voor de tooltip bij hover
                        title: `Relatie: ${d.rollabel}`
                    }))
                );

                // 3. Netwerk Tekenen
                const data = { nodes: nodes, edges: edges };
                
                network = new vis.Network(container, data, options);
                
                // Zorg dat het netwerk in beeld past
                network.fit(); 

            } catch (error) {
                console.error("Fout bij het laden van de bestanden:", error);
                container.innerHTML = "<h2>Data Laadfout: Netwerk is leeg</h2><p>Controleer of de bestanden **'nodes.csv'** en **'edges.csv'** in **dezelfde map** staan.</p>";
            }
        }

        // Start het proces
        loadAndDrawNetwork();
    </script>

</body>
</html>
